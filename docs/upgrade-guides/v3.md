# Upgrade Guide: V2 to V3

This guide provides a comprehensive walkthrough for upgrading from V2 to V3 of the Planning Center PHP SDK. V3 represents a complete architectural rewrite with breaking
changes to improve developer experience, type safety, and API consistency.

## Table of Contents

- [Overview of Changes](#overview-of-changes)
- [Breaking Changes Summary](#breaking-changes-summary)
- [Migration Strategy](#migration-strategy)
- [Module-by-Module Migration Guide](#module-by-module-migration-guide)
    - [People Module](#people-module)
    - [Groups Module](#groups-module)
    - [Calendar Module](#calendar-module)
    - [Webhooks Module](#webhooks-module)
- [Response Handling Changes](#response-handling-changes)
- [Pagination Changes](#pagination-changes)
- [Automated Migration Tips](#automated-migration-tips)

---

## Overview of Changes

### Architecture Changes

V3 introduces a completely new architecture:

**V2 Structure:**

- `src/Objects/{Module}/{Resource}.php` - Object classes
- `src/Objects/{Module}/Attributes/{Resource}Attributes.php` - Attribute classes
- Direct property access via `$resource->attributes->propertyName`
- Returns `ClientResponse` objects with data collections
- Uses `AttributeMapper` utility for mapping

**V3 Structure:**

- `src/PlanningCenter.php` - Singleton entry point
- `src/Modules/{Module}Module.php` - Module factories
- `src/Resources/{Resource}.php` - Unified resource classes
- Fluent API with method chaining
- Returns resource instances or `Paginator` objects
- Uses `HasAttributes` trait with Collection-based storage

### Key Improvements

1. **Fluent Interface**: Method chaining for better readability
2. **Smart Save**: Automatically determines create vs update
3. **Type Safety**: Explicit return types and typed properties
4. **Consistent API**: Unified patterns across all modules
5. **Better Pagination**: Dedicated `Paginator` class
6. **Module Organization**: Clear module boundaries

### Important: Supported API Patterns

**⚠️ All interactions with the SDK must go through `PlanningCenter::make()`**

The only supported pattern for using the SDK is:

```php
PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->moduleName()
    ->resourceName();
```

**Unsupported patterns (no backward compatibility guarantee):**

- Direct resource instantiation: `new Person($clientId, $clientSecret)` ❌
- Direct static method calls: `Email::forPerson($clientId, $clientSecret, $id)` ❌
- Accessing resources without going through PlanningCenter singleton ❌

Always use the PlanningCenter singleton as your entry point. Any other access pattern is considered internal implementation detail and is subject to change without
notice.

---

## Breaking Changes Summary

### 1. Namespace Changes

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\People\Person;
use EncoreDigitalGroup\PlanningCenter\Objects\People\Email;
use EncoreDigitalGroup\PlanningCenter\Objects\Groups\Group;
use EncoreDigitalGroup\PlanningCenter\Objects\Calendar\Event;
use EncoreDigitalGroup\PlanningCenter\Objects\Webhooks\WebhookSubscription;
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;
use EncoreDigitalGroup\PlanningCenter\Resources\Person;
use EncoreDigitalGroup\PlanningCenter\Resources\Email;
use EncoreDigitalGroup\PlanningCenter\Resources\Group;
use EncoreDigitalGroup\PlanningCenter\Resources\CalendarEvent;
use EncoreDigitalGroup\PlanningCenter\Resources\WebhookSubscription;
```

### 2. Instantiation Changes

**V2:**

```php
$person = Person::make($clientId, $clientSecret);
```

**V3:**

```php
$person = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->person();
```

### 3. Attribute Access Changes

**V2:**

```php
// Setting attributes
$person->attributes->firstName = "John";
$person->attributes->lastName = "Smith";

// Getting attributes
$name = $person->attributes->firstName;
```

**V3:**

```php
// Setting attributes (fluent)
$person->withFirstName("John")
    ->withLastName("Smith");

// Getting attributes
$name = $person->firstName();
```

### 4. Response Type Changes

**V2:**

```php
$response = $person->get();
// Returns: ClientResponse
// Access data: $response->data->first()->attributes->firstName
```

**V3:**

```php
$person = $person->get();
// Returns: Person (resource instance)
// Access data: $person->firstName()
```

### 5. List Operations Changes

**V2:**

```php
$response = $person->all();
// Returns: ClientResponse with Collection in $response->data
foreach ($response->data as $personObj) {
    echo $personObj->attributes->firstName;
}
```

**V3:**

```php
$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->all();
// Returns: Paginator
foreach ($paginator->items() as $person) {
    echo $person->firstName();
}
```

### 6. Method Naming Changes

| V2 Method          | V3 Method     | Notes                               |
|--------------------|---------------|-------------------------------------|
| `forPersonId($id)` | `withId($id)` | Consistent naming                   |
| `forEventId($id)`  | `withId($id)` | Consistent naming                   |
| `forGroupId($id)`  | `withId($id)` | Consistent naming                   |
| `create()`         | `save()`      | Smart save (create or update)       |
| `update()`         | `save()`      | Smart save (create or update)       |
| `get()`            | `get()`       | Same, but returns resource instance |
| `all()`            | `all()`       | Same, but returns Paginator         |

---

## Migration Strategy

### Step 1: Update Dependencies

Ensure you're using V3 of the SDK:

```bash
composer require encoredigitalgroup/planningcenter:^3.0
```

### Step 2: Update Imports

Replace all V2 namespaces with V3 namespaces:

**Search and Replace:**

```php
// Find:
use EncoreDigitalGroup\PlanningCenter\Objects\People\
// Replace with:
use EncoreDigitalGroup\PlanningCenter\Resources\

// Find:
use EncoreDigitalGroup\PlanningCenter\Objects\Groups\
// Replace with:
use EncoreDigitalGroup\PlanningCenter\Resources\

// Find:
use EncoreDigitalGroup\PlanningCenter\Objects\Calendar\
// Replace with:
use EncoreDigitalGroup\PlanningCenter\Resources\

// Find:
use EncoreDigitalGroup\PlanningCenter\Objects\Webhooks\
// Replace with:
use EncoreDigitalGroup\PlanningCenter\Resources\
```

**Add the main PlanningCenter class:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;
use EncoreDigitalGroup\PlanningCenter\Support\Paginator;
```

**Remove old response types:**

```php
// Remove:
use EncoreDigitalGroup\PlanningCenter\Objects\SdkObjects\ClientResponse;
```

### Step 3: Update Resource Name Changes

Some resources have been renamed for clarity:

| V2 Name               | V3 Name            |
|-----------------------|--------------------|
| `Event` (Calendar)    | `CalendarEvent`    |
| `Tag` (Calendar)      | `CalendarTag`      |
| `TagGroup` (Calendar) | `CalendarTagGroup` |
| `Event` (Groups)      | `GroupEvent`       |
| `Tag` (Groups)        | `GroupTag`         |
| `TagGroup` (Groups)   | `GroupTagGroup`    |

### Step 4: Refactor Code Patterns

Follow the module-specific guides below.

---

## Module-by-Module Migration Guide

### People Module

#### Creating a Person

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\People\Person;

$person = Person::make($clientId, $clientSecret);
$person->attributes->firstName = "John";
$person->attributes->lastName = "Smith";
$person->attributes->gender = "Male";
$person->attributes->birthdate = "1990-01-01";

$response = $person->create();
$createdPerson = $response->data->first();
$personId = $createdPerson->attributes->personId;
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$person = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->person()
    ->withFirstName("John")
    ->withLastName("Smith")
    ->withGender("Male")
    ->withBirthdate("1990-01-01")
    ->save(); // Smart save - creates because no ID

$personId = $person->id();
```

#### Retrieving a Person

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\People\Person;

$person = Person::make($clientId, $clientSecret);
$response = $person
    ->forPersonId("123")
    ->get();

$personData = $response->data->first();
$firstName = $personData->attributes->firstName;
$lastName = $personData->attributes->lastName;
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$person = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->person()
    ->withId("123")
    ->get();

$firstName = $person->firstName();
$lastName = $person->lastName();
```

#### Updating a Person

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\People\Person;

$person = Person::make($clientId, $clientSecret);
$person->attributes->personId = "123";
$person->attributes->firstName = "Jane";

$response = $person->update();
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$person = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->person()
    ->withId("123")
    ->withFirstName("Jane")
    ->save(); // Smart save - updates because ID exists
```

#### Deleting a Person

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\People\Person;

$person = Person::make($clientId, $clientSecret);
$response = $person
    ->forPersonId("123")
    ->delete();

$success = $response->data->isEmpty();
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$person = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->person()
    ->withId("123");

$success = $person->delete(); // Returns boolean
```

#### Listing All People

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\People\Person;

$person = Person::make($clientId, $clientSecret);
$response = $person->all();

foreach ($response->data as $personObj) {
    echo $personObj->attributes->firstName . "\n";
}

// With query parameters
$response = $person->all(['where[first_name]' => 'John']);
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->all();

foreach ($paginator->items() as $person) {
    echo $person->firstName() . "\n";
}

// With query parameters
$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->all(['where[first_name]' => 'John']);
```

#### Working with Emails

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\People\Email;

// Get emails for a person
$email = Email::make($clientId, $clientSecret);
$response = $email
    ->forPersonId("123")
    ->person();

foreach ($response->data as $emailObj) {
    echo $emailObj->attributes->address . "\n";
}

// Get specific email
$email = Email::make($clientId, $clientSecret);
$response = $email
    ->forEmailAddressId("456")
    ->get();

$emailData = $response->data->first();
$address = $emailData->attributes->address;
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

// Get emails for a person via relationship
$person = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->person()
    ->withId("123")
    ->get();

$emails = $person->emails(); // Returns Collection

foreach ($emails as $email) {
    echo $email->address() . "\n";
}

// Get specific email
$email = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->email()
    ->withId("456")
    ->get();

$address = $email->address();

// Create email
$email = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->email()
    ->withAddress("john@example.com")
    ->withLocation("home")
    ->withPrimary(true)
    ->save();
```

#### Person Attributes Reference

Common V2 → V3 attribute mappings:

| V2 Attribute                             | V3 Method (Set)                  | V3 Method (Get)         |
|------------------------------------------|----------------------------------|-------------------------|
| `$person->attributes->personId`          | `->withId($id)`                  | `->id()`                |
| `$person->attributes->firstName`         | `->withFirstName($name)`         | `->firstName()`         |
| `$person->attributes->lastName`          | `->withLastName($name)`          | `->lastName()`          |
| `$person->attributes->middleName`        | `->withMiddleName($name)`        | `->middleName()`        |
| `$person->attributes->nickname`          | `->withNickname($name)`          | `->nickname()`          |
| `$person->attributes->birthdate`         | `->withBirthdate($date)`         | `->birthdate()`         |
| `$person->attributes->anniversary`       | `->withAnniversary($date)`       | `->anniversary()`       |
| `$person->attributes->gender`            | `->withGender($gender)`          | `->gender()`            |
| `$person->attributes->grade`             | `->withGrade($grade)`            | `->grade()`             |
| `$person->attributes->child`             | `->withChild($bool)`             | `->child()`             |
| `$person->attributes->graduationYear`    | `->withGraduationYear($year)`    | `->graduationYear()`    |
| `$person->attributes->siteAdministrator` | `->withSiteAdministrator($bool)` | `->siteAdministrator()` |
| `$person->attributes->medicalNotes`      | `->withMedicalNotes($notes)`     | `->medicalNotes()`      |
| `$person->attributes->createdAt`         | N/A (read-only)                  | `->createdAt()`         |
| `$person->attributes->updatedAt`         | N/A (read-only)                  | `->updatedAt()`         |

---

### Groups Module

#### Listing Groups

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Groups\Group;

$group = Group::make($clientId, $clientSecret);
$response = $group->all();

foreach ($response->data as $groupObj) {
    echo $groupObj->attributes->name . "\n";
}

// My groups
$response = $group->mine();
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->groups()
    ->all();

foreach ($paginator->items() as $group) {
    echo $group->name() . "\n";
}

// My groups (use query filter)
$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->groups()
    ->all(['filter' => 'my_groups']);
```

#### Getting a Group

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Groups\Group;

$group = Group::make($clientId, $clientSecret);
$response = $group
    ->forGroupId("123")
    ->get();

$groupData = $response->data->first();
$name = $groupData->attributes->name;
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$group = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->groups()
    ->group()
    ->withId("123")
    ->get();

$name = $group->name();
```

#### Group Memberships

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Groups\Group;

$group = Group::make($clientId, $clientSecret);
$response = $group
    ->forGroupId("123")
    ->memberships();

foreach ($response->data as $membership) {
    echo $membership->attributes->role . "\n";
}
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

// Get memberships for a group via relationship
$group = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->groups()
    ->group()
    ->withId("123")
    ->get();

$memberships = $group->memberships(); // Returns Collection

foreach ($memberships as $membership) {
    echo $membership->role() . "\n";
}
```

#### Group Attributes Reference

| V2 Attribute                             | V3 Method (Set)                  | V3 Method (Get)          |
|------------------------------------------|----------------------------------|--------------------------|
| `$group->attributes->groupId`            | `->withId($id)`                  | `->id()`                 |
| `$group->attributes->name`               | `->withName($name)`              | `->name()`               |
| `$group->attributes->description`        | `->withDescription($desc)`       | `->description()`        |
| `$group->attributes->schedule`           | `->withSchedule($schedule)`      | `->schedule()`           |
| `$group->attributes->contactEmail`       | `->withContactEmail($email)`     | `->contactEmail()`       |
| `$group->attributes->virtualLocationUrl` | `->withVirtualLocationUrl($url)` | `->virtualLocationUrl()` |
| `$group->attributes->archivedAt`         | N/A (read-only)                  | `->archivedAt()`         |
| `$group->attributes->createdAt`          | N/A (read-only)                  | `->createdAt()`          |

---

### Calendar Module

**Note:** The Calendar module is **read-only**. V3 does not add create/update/delete methods because the Planning Center API doesn't support them for Calendar resources.

#### Listing Calendar Events

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Calendar\Event;

$event = Event::make($clientId, $clientSecret);
$response = $event->all();

foreach ($response->data as $eventObj) {
    echo $eventObj->attributes->name . "\n";
}
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->calendar()
    ->all();

foreach ($paginator->items() as $event) {
    echo $event->name() . "\n";
}
```

#### Getting a Calendar Event

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Calendar\Event;

$event = Event::make($clientId, $clientSecret);
$response = $event
    ->forEventId("123")
    ->get();

$eventData = $response->data->first();
$name = $eventData->attributes->name;
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$event = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->calendar()
    ->event()
    ->withId("123")
    ->get();

$name = $event->name();
```

#### Event Instances

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Calendar\Event;

$event = Event::make($clientId, $clientSecret);
$response = $event
    ->forEventId("123")
    ->instances();

foreach ($response->data as $instance) {
    echo $instance->attributes->startsAt . "\n";
}
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

// Get event instances via relationship
$event = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->calendar()
    ->event()
    ->withId("123")
    ->get();

$instances = $event->eventInstances(); // Returns Collection

foreach ($instances as $instance) {
    echo $instance->startsAt()->format('Y-m-d H:i:s') . "\n";
}
```

#### Calendar Resource Naming Changes

| V2 Class        | V3 Class               |
|-----------------|------------------------|
| `Event`         | `CalendarEvent`        |
| `EventInstance` | `EventInstance` (same) |
| `Tag`           | `CalendarTag`          |
| `TagGroup`      | `CalendarTagGroup`     |

---

### Webhooks Module

#### Listing Webhook Subscriptions

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Webhooks\WebhookSubscription;

$webhook = WebhookSubscription::make($clientId, $clientSecret);
$response = $webhook->all();

foreach ($response->data as $subscription) {
    echo $subscription->attributes->name . "\n";
    echo $subscription->attributes->url . "\n";
}
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->webhooks()
    ->all();

foreach ($paginator->items() as $subscription) {
    echo $subscription->name() . "\n";
    echo $subscription->url() . "\n";
}
```

#### Getting a Webhook Subscription

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Webhooks\WebhookSubscription;

$webhook = WebhookSubscription::make($clientId, $clientSecret);
$response = $webhook
    ->forWebhookSubscriptionId("123")
    ->get();

$subscriptionData = $response->data->first();
$name = $subscriptionData->attributes->name;
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$subscription = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->webhooks()
    ->subscription()
    ->withId("123")
    ->get();

$name = $subscription->name();
```

#### Creating a Webhook Subscription

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Webhooks\WebhookSubscription;
use EncoreDigitalGroup\PlanningCenter\Support\PlanningCenterWebhookEvent;

$webhook = WebhookSubscription::make($clientId, $clientSecret);
$webhook->attributes->name = PlanningCenterWebhookEvent::PeoplePersonCreated->value;
$webhook->attributes->url = "https://example.com/webhook";
$webhook->attributes->active = true;

$response = $webhook->create();
$success = $response === true;
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;
use EncoreDigitalGroup\PlanningCenter\Support\PlanningCenterWebhookEvent;

$subscription = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->webhooks()
    ->subscription()
    ->withName(PlanningCenterWebhookEvent::PeoplePersonCreated->value)
    ->withUrl("https://example.com/webhook")
    ->withActive(true)
    ->save(); // Returns WebhookSubscription instance

$id = $subscription->id();
```

#### Updating a Webhook Subscription

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Webhooks\WebhookSubscription;

$webhook = WebhookSubscription::make($clientId, $clientSecret);
$webhook->attributes->webhookSubscriptionId = "123";
$webhook->attributes->active = false;

$response = $webhook->update();
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$subscription = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->webhooks()
    ->subscription()
    ->withId("123")
    ->withActive(false)
    ->save(); // Smart save - updates because ID exists
```

#### Deleting a Webhook Subscription

**V2:**

```php
use EncoreDigitalGroup\PlanningCenter\Objects\Webhooks\WebhookSubscription;

$webhook = WebhookSubscription::make($clientId, $clientSecret);
$response = $webhook
    ->forWebhookSubscriptionId("123")
    ->delete();

$success = $response->data->isEmpty();
```

**V3:**

```php
use EncoreDigitalGroup\PlanningCenter\PlanningCenter;

$subscription = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->webhooks()
    ->subscription()
    ->withId("123");

$success = $subscription->delete(); // Returns boolean
```

---

## Response Handling Changes

### V2 Response Structure

V2 returned `ClientResponse` objects:

```php
$response = $person->get();

// Response structure:
// $response->data          -> Collection of resource objects
// $response->meta          -> Metadata container
// $response->meta->response -> Raw HTTP response

// Accessing data:
$personObj = $response->data->first();
$firstName = $personObj->attributes->firstName;

// Checking success:
if ($response->data->isNotEmpty()) {
    // Success
}
```

### V3 Response Structure

V3 returns resource instances or Paginator objects directly:

```php
// Single resource operations return the resource
$person = $person->get();
$firstName = $person->firstName();

// List operations return Paginator
$paginator = $module->all();
foreach ($paginator->items() as $resource) {
    // Process resource
}

// Boolean operations return bool
$success = $person->delete(); // true/false
```

---

## Pagination Changes

### V2 Pagination

V2 returned all data in a Collection:

```php
$response = $person->all();
$people = $response->data; // Collection of all items in response

// No built-in pagination support
// Manual query parameters for pagination:
$response = $person->all([
    'per_page' => 25,
    'offset' => 50
]);
```

### V3 Pagination

V3 provides a dedicated `Paginator` class:

```php
$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->all();

// Access current page items
$items = $paginator->items(); // Collection

// Pagination info
$total = $paginator->totalCount();
$perPage = $paginator->perPage();
$hasMore = $paginator->hasMore();
$hasPrevious = $paginator->hasPrevious();

// Get URLs for navigation
$nextUrl = $paginator->nextUrl();
$prevUrl = $paginator->prevUrl();

// Iterate current page
foreach ($paginator->items() as $person) {
    echo $person->firstName() . "\n";
}

// Query parameters still supported
$paginator = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->people()
    ->all([
        'per_page' => 50,
        'offset' => 100,
        'where[first_name]' => 'John'
    ]);
```

---

## Automated Migration Tips

### For LLM-Based Migration

When using an LLM to automate migration, follow these patterns:

#### 1. Identify V2 Patterns

**Search for:**

- `::make($clientId, $clientSecret)` → Replace with PlanningCenter singleton
- `->attributes->` → Replace with fluent getters/setters
- `->forXXXId($id)` → Replace with `->withId($id)`
- `ClientResponse` type hints → Replace with resource or Paginator types
- `$response->data` access → Replace with direct resource usage

#### 2. Pattern Replacements

**Initialization Pattern:**

```php
// V2 Pattern:
$resource = ResourceClass::make($clientId, $clientSecret);

// V3 Pattern:
$resource = PlanningCenter::make()
    ->withBasicAuth($clientId, $clientSecret)
    ->moduleName()
    ->resourceName();
```

**Attribute Setting Pattern:**

```php
// V2 Pattern:
$resource->attributes->propertyName = $value;

// V3 Pattern:
$resource->withPropertyName($value);
```

**Attribute Getting Pattern:**

```php
// V2 Pattern:
$value = $resource->attributes->propertyName;

// V3 Pattern:
$value = $resource->propertyName();
```

**Method Call Pattern:**

```php
// V2 Pattern:
$response = $resource->method();
$data = $response->data->first();

// V3 Pattern (single resource):
$resource = $resource->method();

// V3 Pattern (list):
$paginator = $resource->method();
$data = $paginator->items();
```

#### 3. Module Name Mapping

| V2 Namespace Segment | V3 Module Method |
|----------------------|------------------|
| `Objects\People\`    | `->people()`     |
| `Objects\Groups\`    | `->groups()`     |
| `Objects\Calendar\`  | `->calendar()`   |
| `Objects\Webhooks\`  | `->webhooks()`   |

#### 4. Resource Factory Method Mapping

| Module   | Resource Class      | Factory Method      |
|----------|---------------------|---------------------|
| People   | Person              | `->person()`        |
| People   | Email               | `->email()`         |
| People   | PersonMerger        | `->personMerger()`  |
| Groups   | Group               | `->group()`         |
| Groups   | GroupEvent          | `->event()`         |
| Groups   | GroupMembership     | `->membership()`    |
| Groups   | GroupTag            | `->tag()`           |
| Groups   | GroupTagGroup       | `->tagGroup()`      |
| Calendar | CalendarEvent       | `->event()`         |
| Calendar | EventInstance       | `->eventInstance()` |
| Calendar | CalendarTag         | `->tag()`           |
| Calendar | CalendarTagGroup    | `->tagGroup()`      |
| Webhooks | WebhookSubscription | `->subscription()`  |

#### 5. CRUD Operation Mapping

| Operation     | V2 Method    | V3 Method    | V3 Return Type    |
|---------------|--------------|--------------|-------------------|
| Create        | `->create()` | `->save()`   | Resource instance |
| Read (single) | `->get()`    | `->get()`    | Resource instance |
| Read (list)   | `->all()`    | `->all()`    | Paginator         |
| Update        | `->update()` | `->save()`   | Resource instance |
| Delete        | `->delete()` | `->delete()` | bool              |

#### 6. Common Property Name Patterns

Property names follow camelCase → snake_case conversion for the API, but in V3 they're accessed via methods:

```php
// Pattern: $v2->attributes->camelCaseName = $value;
// Becomes: $v3->withCamelCaseName($value);

// Pattern: $value = $v2->attributes->camelCaseName;
// Becomes: $value = $v3->camelCaseName();
```

Examples:

- `firstName` → `withFirstName($name)` / `firstName()`
- `lastName` → `withLastName($name)` / `lastName()`
- `contactEmail` → `withContactEmail($email)` / `contactEmail()`
- `virtualLocationUrl` → `withVirtualLocationUrl($url)` / `virtualLocationUrl()`

---

## Testing Your Migration

After migration, ensure you test:

1. **Authentication**: Verify credentials are properly set
2. **Create Operations**: Test resource creation
3. **Read Operations**: Test single resource retrieval
4. **List Operations**: Test pagination handling
5. **Update Operations**: Test resource updates
6. **Delete Operations**: Test resource deletion
7. **Relationships**: Test relationship loading (where applicable)
8. **Error Handling**: Verify exception handling still works

---

## Need Help?

If you encounter issues during migration:

1. Review the [V3 Documentation](../README.md)
2. Check the [test files](../../tests/) for working examples
3. Open an issue on [GitHub](https://github.com/encoredigitalgroup/planningcenter-php-sdk/issues)

---

## Summary Checklist

- [ ] Update composer dependency to `^3.0`
- [ ] Update all `use` statements
- [ ] Replace `::make()` calls with `PlanningCenter::make()->withBasicAuth()`
- [ ] Replace `->attributes->` access with fluent methods
- [ ] Replace `->forXXXId()` with `->withId()`
- [ ] Replace `->create()` and `->update()` with `->save()`
- [ ] Update response handling (remove `->data->first()`)
- [ ] Update list operation handling (use `->items()` on Paginator)
- [ ] Update type hints (remove ClientResponse, add Paginator)
- [ ] Rename Calendar and Groups resources if used
- [ ] Run tests to verify functionality
- [ ] Update any documentation or comments

---